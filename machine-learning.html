<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Machine Learning in Motion | AI Learning Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        aurora: '#34d399',
                        cyantrack: '#06b6d4',
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                },
            },
        };
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha384-4iOpy9lR++k59mItRbg0BKX38nS4EnkbWrH9H7dWz5PUSxH0a++kY8sMTpNGdis" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle at 15% 20%, rgba(52, 211, 153, 0.1), transparent 45%),
                radial-gradient(circle at 80% 10%, rgba(6, 182, 212, 0.09), transparent 45%),
                #020617;
        }
        .metric-card {
            background: rgba(15, 23, 42, 0.65);
            border: 1px solid rgba(71, 85, 105, 0.45);
            border-radius: 18px;
            padding: 18px;
        }
        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #e2e8f0;
        }
        canvas {
            background: radial-gradient(circle at top right, rgba(6, 182, 212, 0.08), transparent 60%),
                rgba(2, 6, 23, 0.9);
            border-radius: 24px;
        }
        .data-feed {
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
        }
        .data-feed::-webkit-scrollbar {
            width: 6px;
        }
        .data-feed::-webkit-scrollbar-thumb {
            background: rgba(148, 163, 184, 0.4);
            border-radius: 9999px;
        }
    </style>
</head>
<body class="text-slate-100 min-h-screen flex flex-col">
    <header class="bg-slate-950/80 border-b border-slate-800 backdrop-blur sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between py-5">
                <a href="index.html" class="flex items-center gap-3">
                    <div class="h-11 w-11 rounded-xl bg-gradient-to-br from-aurora via-cyantrack to-sky-500 flex items-center justify-center font-bold text-slate-950 text-xl">AI</div>
                    <span class="text-lg font-semibold tracking-wide">AI Learning Lab</span>
                </a>
                <nav class="hidden md:flex items-center gap-8 text-sm font-medium text-slate-300">
                    <a href="machine-learning.html" class="text-emerald-300">Machine Learning</a>
                    <a href="neural-networks.html" class="hover:text-white transition">Neural Networks</a>
                    <a href="reinforcement-learning.html" class="hover:text-white transition">Reinforcement Learning</a>
                    <a href="reasoning.html" class="hover:text-white transition">Reasoning</a>
                    <a href="hierarchical-reasoning.html" class="hover:text-white transition">Hierarchical Reasoning</a>
                </nav>
                <button id="mobile-menu-button" class="md:hidden text-slate-200">
                    <svg class="h-7 w-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
            <div id="mobile-menu" class="md:hidden hidden pb-6">
                <nav class="flex flex-col gap-3 text-sm font-medium text-slate-200">
                    <a href="machine-learning.html" class="text-emerald-300">Machine Learning</a>
                    <a href="neural-networks.html" class="hover:text-white transition">Neural Networks</a>
                    <a href="reinforcement-learning.html" class="hover:text-white transition">Reinforcement Learning</a>
                    <a href="reasoning.html" class="hover:text-white transition">Reasoning</a>
                    <a href="hierarchical-reasoning.html" class="hover:text-white transition">Hierarchical Reasoning</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="flex-1">
        <section class="relative overflow-hidden border-b border-slate-800/60">
            <div class="absolute -top-32 -left-24 h-96 w-96 rounded-full bg-emerald-500/20 blur-3xl"></div>
            <div class="absolute bottom-0 right-0 h-64 w-64 rounded-full bg-cyan-500/10 blur-3xl"></div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 relative">
                <a href="index.html" class="inline-flex items-center text-sm text-slate-400 hover:text-white">
                    ← Back to overview
                </a>
                <div class="mt-6 max-w-3xl">
                    <h1 class="text-4xl font-bold text-white">Machine Learning in Motion</h1>
                    <p class="mt-4 text-lg text-slate-300">
                        Tune a live gradient descent trainer that responds to streaming samples. Adjust learning rates, inspect error, and follow parameters as they settle around the true signal.
                    </p>
                </div>
                <div class="mt-10 grid gap-6 sm:grid-cols-3">
                    <div class="metric-card">
                        <p class="text-xs uppercase tracking-wide text-slate-400">True signal</p>
                        <p class="metric-value" id="true-model">y = 0</p>
                        <p class="mt-1 text-xs text-slate-500">Hidden slope and intercept driving observations</p>
                    </div>
                    <div class="metric-card">
                        <p class="text-xs uppercase tracking-wide text-slate-400">Current hypothesis</p>
                        <p class="metric-value" id="current-model">m = 0, b = 0</p>
                        <p class="mt-1 text-xs text-slate-500">Updated after every streaming batch</p>
                    </div>
                    <div class="metric-card">
                        <p class="text-xs uppercase tracking-wide text-slate-400">Loss</p>
                        <p class="metric-value" id="loss-value">0.000</p>
                        <p class="mt-1 text-xs text-slate-500">Mean squared error over the current window</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid gap-10 lg:grid-cols-[1.6fr,1fr]">
                    <div class="bg-slate-950/70 border border-slate-800 rounded-[28px] p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl font-semibold text-white">Streaming regression trainer</h2>
                                <p class="text-sm text-slate-400">Data points flow continuously while the model adapts.</p>
                            </div>
                            <span class="inline-flex items-center gap-2 rounded-full bg-emerald-500/15 px-3 py-1 text-xs font-semibold text-emerald-300">
                                <span class="h-2 w-2 rounded-full bg-emerald-300 animate-ping"></span>
                                Live
                            </span>
                        </div>
                        <div class="mt-6">
                            <canvas id="regressionChart" class="w-full h-[420px]"></canvas>
                        </div>
                    </div>
                    <div class="bg-slate-950/70 border border-slate-800 rounded-[28px] p-6 flex flex-col gap-6">
                        <div>
                            <h3 class="text-xl font-semibold text-white">Trainer controls</h3>
                            <p class="mt-2 text-sm text-slate-400">Set how aggressively the model reacts to each new sample.</p>
                        </div>
                        <div>
                            <label for="learning-rate" class="text-xs uppercase tracking-wide text-slate-400">Learning rate</label>
                            <div class="mt-2 flex items-center gap-4">
                                <input id="learning-rate" type="range" min="0.001" max="0.25" step="0.001" value="0.045" class="w-full accent-emerald-400" />
                                <span id="learning-rate-value" class="text-sm font-semibold text-emerald-300">0.045</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm text-slate-300">
                            <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
                                <p class="text-xs uppercase tracking-wide text-slate-400">Epochs</p>
                                <p class="mt-2 text-lg font-semibold text-white" id="epoch-count">0</p>
                                <p class="mt-1 text-xs text-slate-500">How many gradient steps have run</p>
                            </div>
                            <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
                                <p class="text-xs uppercase tracking-wide text-slate-400">Samples tracked</p>
                                <p class="mt-2 text-lg font-semibold text-white" id="sample-count">0</p>
                                <p class="mt-1 text-xs text-slate-500">Active window of streaming observations</p>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-3">
                            <button id="toggle-training" class="flex-1 rounded-full bg-gradient-to-r from-emerald-400 to-cyantrack px-4 py-2 text-sm font-semibold text-slate-950 shadow-lg shadow-emerald-400/30 hover:shadow-xl hover:shadow-cyantrack/40">Start real-time learning</button>
                            <button id="reset-training" class="rounded-full border border-slate-700 px-4 py-2 text-sm font-semibold text-slate-200 hover:border-emerald-400/60 hover:text-white">Reset</button>
                        </div>
                        <div>
                            <p class="text-xs uppercase tracking-wide text-slate-400">Latest samples</p>
                            <div id="sample-feed" class="data-feed mt-3 space-y-2 text-xs text-slate-300 font-mono"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-16 grid gap-10 lg:grid-cols-2">
                    <div class="bg-slate-950/70 border border-slate-800 rounded-[28px] p-6">
                        <h3 class="text-xl font-semibold text-white">What to observe</h3>
                        <ul class="mt-4 space-y-3 text-sm text-slate-300">
                            <li><span class="font-semibold text-emerald-300">Convergence rhythm:</span> Low learning rates converge steadily; higher rates oscillate before settling.</li>
                            <li><span class="font-semibold text-emerald-300">Noise adaptation:</span> New samples slightly perturb the fit—watch the loss spike and recover.</li>
                            <li><span class="font-semibold text-emerald-300">Bias vs. variance:</span> Reset and rerun to see how initialization influences the early trajectory.</li>
                        </ul>
                    </div>
                    <div class="bg-slate-950/70 border border-slate-800 rounded-[28px] p-6">
                        <h3 class="text-xl font-semibold text-white">How it works</h3>
                        <ol class="mt-4 space-y-3 text-sm text-slate-300 list-decimal list-inside">
                            <li>Streaming data points are generated from a hidden linear relationship with gaussian noise.</li>
                            <li>The model collects the latest window of samples and runs gradient descent on every tick.</li>
                            <li>Loss, slope, and intercept update in real time so you can witness convergence as it happens.</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="border-t border-slate-800/60 bg-slate-950/80">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 text-sm text-slate-400 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
            <p>© <span id="footer-year"></span> AI Learning Lab.</p>
            <p>Experiment, pause, and reset to compare learning behaviors.</p>
        </div>
    </footer>

    <script>
        const mobileButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        if (mobileButton && mobileMenu) {
            mobileButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
        const yearTarget = document.getElementById('footer-year');
        if (yearTarget) {
            yearTarget.textContent = new Date().getFullYear();
        }

        const ctx = document.getElementById('regressionChart');
        const learningRateInput = document.getElementById('learning-rate');
        const learningRateDisplay = document.getElementById('learning-rate-value');
        const epochDisplay = document.getElementById('epoch-count');
        const sampleDisplay = document.getElementById('sample-count');
        const trueModelDisplay = document.getElementById('true-model');
        const currentModelDisplay = document.getElementById('current-model');
        const lossDisplay = document.getElementById('loss-value');
        const sampleFeed = document.getElementById('sample-feed');
        const toggleTrainingButton = document.getElementById('toggle-training');
        const resetButton = document.getElementById('reset-training');

        const trueSlope = (Math.random() * 4 - 2).toFixed(2);
        const trueIntercept = (Math.random() * 4 - 2).toFixed(2);
        trueModelDisplay.textContent = `y = ${trueSlope}x ${trueIntercept >= 0 ? '+' : '-'} ${Math.abs(trueIntercept)}`;

        let hypothesis = {
            slope: parseFloat((Math.random() * 2 - 1).toFixed(3)),
            intercept: parseFloat((Math.random() * 2 - 1).toFixed(3)),
        };
        let epoch = 0;
        let samples = [];
        let trainingLoop = null;
        const maxSamples = 80;

        function generateSample() {
            const x = (Math.random() * 12 - 6);
            const noise = (Math.random() - 0.5) * 2;
            const y = parseFloat(trueSlope) * x + parseFloat(trueIntercept) + noise;
            return { x: parseFloat(x.toFixed(2)), y: parseFloat(y.toFixed(2)) };
        }

        function initializeSamples() {
            samples = Array.from({ length: 32 }, generateSample);
        }

        function getLinePoints() {
            if (!samples.length) {
                return [
                    { x: -6, y: hypothesis.slope * -6 + hypothesis.intercept },
                    { x: 6, y: hypothesis.slope * 6 + hypothesis.intercept },
                ];
            }
            const xs = samples.map((p) => p.x);
            const minX = Math.min(...xs);
            const maxX = Math.max(...xs);
            return [
                { x: minX, y: hypothesis.slope * minX + hypothesis.intercept },
                { x: maxX, y: hypothesis.slope * maxX + hypothesis.intercept },
            ];
        }

        const regressionChart = new Chart(ctx, {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Streaming samples',
                        data: [],
                        backgroundColor: 'rgba(16, 185, 129, 0.75)',
                        borderColor: 'rgba(16, 185, 129, 0.95)',
                        pointRadius: 4,
                        pointHoverRadius: 5,
                    },
                    {
                        type: 'line',
                        label: 'Model prediction',
                        data: getLinePoints(),
                        borderColor: 'rgba(59, 130, 246, 0.8)',
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.15,
                    },
                ],
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: false,
                scales: {
                    x: {
                        title: { display: true, text: 'x', color: '#cbd5f5' },
                        ticks: { color: '#94a3b8' },
                        grid: { color: 'rgba(148, 163, 184, 0.12)' },
                    },
                    y: {
                        title: { display: true, text: 'y', color: '#cbd5f5' },
                        ticks: { color: '#94a3b8' },
                        grid: { color: 'rgba(148, 163, 184, 0.12)' },
                    },
                },
                plugins: {
                    legend: {
                        labels: {
                            color: '#cbd5f5',
                            font: { family: 'Inter' },
                        },
                    },
                    tooltip: {
                        callbacks: {
                            label: (ctx) => `(${ctx.parsed.x.toFixed(2)}, ${ctx.parsed.y.toFixed(2)})`,
                        },
                    },
                },
            },
        });

        function updateChart() {
            regressionChart.data.datasets[0].data = samples;
            regressionChart.data.datasets[1].data = getLinePoints();
            regressionChart.update();
        }

        function updateSampleFeed() {
            if (!sampleFeed) return;
            const recent = [...samples.slice(-12)].reverse();
            sampleFeed.innerHTML = recent
                .map((sample, index) => {
                    const { x, y } = sample;
                    return `<div class="flex items-center justify-between rounded-xl border border-slate-800 bg-slate-900/50 px-3 py-2"><span class="text-slate-400">Sample ${samples.length - index}</span><span class="text-emerald-300">(${x.toFixed(2)}, ${y.toFixed(2)})</span></div>`;
                })
                .join('');
        }

        function updateMetrics() {
            if (epochDisplay) epochDisplay.textContent = epoch.toLocaleString();
            if (sampleDisplay) sampleDisplay.textContent = samples.length.toLocaleString();
            if (currentModelDisplay) {
                currentModelDisplay.textContent = `m = ${hypothesis.slope.toFixed(3)}, b = ${hypothesis.intercept.toFixed(3)}`;
            }
            if (lossDisplay) {
                const loss = samples.reduce((acc, point) => {
                    const prediction = hypothesis.slope * point.x + hypothesis.intercept;
                    const err = prediction - point.y;
                    return acc + err * err;
                }, 0) / Math.max(samples.length, 1);
                lossDisplay.textContent = loss.toFixed(3);
            }
        }

        function gradientStep() {
            if (!samples.length) return;
            const lr = parseFloat(learningRateInput.value);
            let gradSlope = 0;
            let gradIntercept = 0;
            samples.forEach((point) => {
                const prediction = hypothesis.slope * point.x + hypothesis.intercept;
                const error = prediction - point.y;
                gradSlope += error * point.x;
                gradIntercept += error;
            });
            const n = samples.length;
            gradSlope = (2 / n) * gradSlope;
            gradIntercept = (2 / n) * gradIntercept;
            hypothesis.slope -= lr * gradSlope;
            hypothesis.intercept -= lr * gradIntercept;
        }

        function streamAndTrain() {
            samples.push(generateSample());
            if (samples.length > maxSamples) {
                samples.shift();
            }
            for (let i = 0; i < 2; i++) {
                gradientStep();
                epoch += 1;
            }
            updateChart();
            updateMetrics();
            updateSampleFeed();
        }

        function startTraining() {
            if (trainingLoop) return;
            toggleTrainingButton.textContent = 'Pause learning';
            trainingLoop = setInterval(streamAndTrain, 350);
        }

        function pauseTraining() {
            if (trainingLoop) {
                clearInterval(trainingLoop);
                trainingLoop = null;
            }
            toggleTrainingButton.textContent = 'Resume learning';
        }

        function resetTraining() {
            pauseTraining();
            hypothesis = {
                slope: parseFloat((Math.random() * 2 - 1).toFixed(3)),
                intercept: parseFloat((Math.random() * 2 - 1).toFixed(3)),
            };
            epoch = 0;
            initializeSamples();
            updateChart();
            updateMetrics();
            updateSampleFeed();
            toggleTrainingButton.textContent = 'Start real-time learning';
        }

        learningRateInput.addEventListener('input', () => {
            learningRateDisplay.textContent = parseFloat(learningRateInput.value).toFixed(3);
        });

        toggleTrainingButton.addEventListener('click', () => {
            if (trainingLoop) {
                pauseTraining();
            } else {
                startTraining();
            }
        });

        resetButton.addEventListener('click', resetTraining);

        initializeSamples();
        updateChart();
        updateMetrics();
        updateSampleFeed();

        window.addEventListener('beforeunload', pauseTraining);
    </script>
</body>
</html>
